<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.green.vrink.admin.repository.interfaces.AdminRepository">

    <update id="changeApply">
        UPDATE apply
        SET accepted = #{accepted}
        WHERE apply_id = #{applyId}
    </update>

    <update id="changeCheater">
        UPDATE apply
        SET cheater = #{content}
        WHERE apply_id = #{applyId}
    </update>

    <select id="getAllAdminApplyList" resultType="com.green.vrink.admin.dto.AdminApplyDto">
        SELECT apply.*, user.nickname
        FROM apply
        INNER JOIN user ON apply.user_id = user.user_id
    </select>

    <select id="getAllAdminApplyListByPaging" parameterType="com.green.vrink.admin.dto.PagingDto" resultType="com.green.vrink.admin.dto.AdminApplyDto">
        SELECT apply.*, user.nickname
        FROM apply
        INNER JOIN user ON apply.user_id = user.user_id
        ORDER BY apply.apply_id DESC
        LIMIT #{offset}, #{recordSize}
    </select>

    <select id="getAllAdminApplyListByTypePaging" parameterType="com.green.vrink.admin.dto.PagingDto" resultType="com.green.vrink.admin.dto.AdminApplyDto">
        SELECT apply.*, user.nickname
        FROM apply
        INNER JOIN user ON apply.user_id = user.user_id
        WHERE apply.accepted = #{classification}
        ORDER BY apply.apply_id DESC
        LIMIT #{offset}, #{recordSize}
    </select>

    <select id="getAllAdminApplyListByType" parameterType="com.green.vrink.admin.dto.PagingDto" resultType="com.green.vrink.admin.dto.AdminApplyDto">
        SELECT apply.*, user.nickname
        FROM apply
        INNER JOIN user ON apply.user_id = user.user_id
        WHERE apply.accepted = #{classification}
        ORDER BY apply.apply_id DESC
    </select>

    <select id="countAllAdminApply" resultType="integer">
        SELECT count(*)
        FROM apply
    </select>

    <select id="countAdminApplyByType" resultType="integer">
        SELECT count(*)
        FROM apply
        WHERE accepted = #{classification}
    </select>

    <select id="countAllFreeboard" resultType="integer">
        SELECT count(*)
        FROM community
    </select>

    <select id="getFreeboardById" resultType="com.green.vrink.community.dto.FreeBoardDTO">
        SELECT community_id, c.user_id, title, c.content, c.created_at, nickname
        FROM community c
        LEFT JOIN user u ON c.user_id = u.user_id
        WHERE c.community_id = #{id}
        ORDER BY community_id DESC
    </select>

    <select id="getAllFreeboardList" resultType="com.green.vrink.community.dto.FreeBoardDTO">
        SELECT community_id, c.user_id, title, c.content, c.created_at, nickname
        FROM community c
        LEFT JOIN user u ON c.user_id = u.user_id
        ORDER BY community_id DESC
    </select>

    <select id="getAllFreeboardListByPaging" resultType="com.green.vrink.community.dto.FreeBoardDTO">
        SELECT community_id, c.user_id, title, c.content, c.created_at, nickname
        FROM community c
        LEFT JOIN user u ON c.user_id = u.user_id
        ORDER BY community_id DESC
        LIMIT #{offset}, #{recordSize}
    </select>

</mapper>