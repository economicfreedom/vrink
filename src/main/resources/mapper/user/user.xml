<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.green.vrink.user.repository.interfaces.UserRepository">


    <select id="requestApproval" resultType="java.lang.Integer">
        insert into apply(user_id, name, number)
            value (#{userId},#{accountName},#{accountNumber})
    </select>
    
    <insert id="signUp">
    	INSERT INTO user 
		(email, password, name, nickname, phone, created_at) 
		VALUES (#{email}, #{password}, #{name}, #{nickname}, #{phone}, now())
    </insert>
    
    <select id="checkEmail" resultType="String">
    	SELECT email FROM user WHERE email = #{email};
    </select>
    <select id="findUserNicknameById" resultType="java.lang.String">
        SELECT nickname
        FROM user
        WHERE user_id = #{userId}

    </select>
    
    <insert id="editorWrite">
    	INSERT INTO editor_detail(user_id, profile_image, introduce, image, content, vrm)
    	VALUES (#{userId}, #{profileImage}, #{introduce}, #{image}, #{content}, #{vrm})
    </insert>
    
    <select id="findByEditorId" resultType="com.green.vrink.user.dto.EditorDTO">
        select ed.editor_id, ed.user_id, ed.profile_image, ed.introduce, ed.image, ed.content, ed.vrm, u.nickname
		from editor_detail ed
		left join user u
		on u.user_id = ed.user_id
		where ed.editor_id = #{editorId};
    </select>
    
    <select id="findVrmById" resultType="java.lang.String">
        SELECT vrm FROM editor_detail
        WHERE editor_id = #{editorId}
    </select>

    <update id="updateByEditorId">
        UPDATE editor_detail SET 
        profile_image=#{profileImage}, introduce=#{introduce}, image=#{image}, content=#{content}, vrm=#{vrm}
        WHERE editor_id = #{editorId}
    </update>
</mapper>